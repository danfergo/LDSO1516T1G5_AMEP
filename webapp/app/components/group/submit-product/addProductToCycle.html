<md-dialog aria-label="Adicionar produto ao ciclo"  role="dialog"
           style="background:transparent;box-shadow: none;width:300px;">
  <div class="locked flip-container"
       ng-class="{flipped: flipCard}"
       flip-card
       layout="column">
    <div class="flipper " flex layout="column">
      <div class="front" layout="column" flex>
        <md-card layout="column" flex>
          <div ng-if="$index % 4 != 3" class="md-card-image"
               style="background-image:url('http://a3145z1.americdn.com/wp-content/uploads/2013/03/orange-king-of-fruits.jpg');
                      background-size:cover;
                      background-position:center center;
                      height:150px;float:right;">
          </div>

          <md-card-title flex="none">
            <md-card-title-text>
              <md-input-container>
                <label>Título</label>
                <input ng-model="currentProduct.title">
              </md-input-container>
            </md-card-title-text>
          </md-card-title>
          <md-card-content flex layout="column" style="overflow-y:auto">
              <md-input-container flex="none">
                <label>Descrição</label>
                  <textarea ng-model="currentProduct.description" columns="1" md-maxlength="300"
                  placeholder="Descreve  o produto"></textarea>
              </md-input-container>

            <div layout="row" flex="none">
              <md-input-container flex="50">
                <label>Categoria</label>
                <md-select ng-model="currentProduct.product_category_id">
                  <md-option ng-repeat="productCategory in productCategories" ng-value="productCategory.id">
                    {{productCategory.name}}
                  </md-option>
                </md-select>
              </md-input-container>
              <md-input-container flex="50"><label>Uni. de medida</label>
                <input ng-model="currentProduct.unit" ng-required="true" type="text">
              </md-input-container>
            </div>
          </md-card-content>
          <md-card-actions flex="none" layout="row" layout-align="end center">
            <md-button class="md-primary" ng-click="addProduct()">Adicionar</md-button>
          </md-card-actions>
        </md-card>
      </div>
      <div class="back" layout="column">
        <form name="editProductStock" layout="column" flex>
          <md-card layout="column" flex>
            <md-card-title flex="none" layout="row">
              <md-card-title-text>
                <span class="md-headline" style="padding: 24px 0px 16px;"> <!-- padding fixes bug -->{{currentProduct.title}}</span>
              </md-card-title-text>
              <div  style="padding-top: 20px" >
                <md-button class="md-icon-button toggle" aria-label="Reverse" style="float:right;">
                  <ng-md-icon icon="rotate_right" size="24"></ng-md-icon>
                </md-button>
              </div>
            </md-card-title>
            <md-card-content flex>
              <div  ng-if="!auth.id"  class="text-right" >
                <div layout="row">
                  <div flex></div>
                  <md-input-container  class="md-block" style="margin-bottom:0;max-width:60px">
                    <label>Ecos</label>
                    <input ng-model="auth.ecos" ng-required="true" type="number" class="input-ecos" step="0.01"
                           min="0" max="99999"
                           ng-pattern="/^[0-9]+(\.[0-9]{1,2})?$/">
                  </md-input-container>
                  <md-input-container class="md-block"  style="margin-bottom:0;max-width:60px">
                    <label>Euros</label>
                    <input ng-model="auth.euros" ng-required="true" type="number"
                           min="0" max="99999"
                           class="input-euros" ng-pattern="/^[0-9]+(\.[0-9]{1,2})?$/">
                  </md-input-container>
                </div>
                / {{currentProduct.unit}}
              </div>

              <div ng-if="auth.id" class="text-right" >
                <b>{{ auth.ecos | currency :'E':2}}</b> +
                {{ auth.euros | currency :'€':2}}<br> /
                {{currentProduct.unit}}
              </div>
              <div>
                <br><br>
              </div>
              <div ng-repeat="week in weeks">
                <md-divider></md-divider>

                <div layout="row" style="margin: 5px 0">
                  <div flex style="padding:1px;line-height:26px;">
                    {{week.delivery_date | date:'dd/MM'}}
                  </div>
                  <div flex>
                    <input ng-model="weeks[$index].quantity"
                           name="week_{{weeks.id}}"
                           ng-if="weeks[$index].selected"
                           ng-required="true"
                           value="1"
                           style="width:40px;padding-left: 3px;
                border:2px solid rgba(0,0,0,0.54); border-radius:2px;outline: none;
                margin: 0 1px;" type="number" step="1" min="0" max="30">
                  </div>
                  <div>
                    <md-checkbox
                      aria-label="Selecionar semana"
                      ng-model="weeks[$index].selected"
                      class="md-warn">
                      <b>{{product.title}}</b>
                    </md-checkbox>
                  </div>
                </div>
              </div>
            </md-card-content>
            <md-card-actions layout="row" layout-align="end center">
              <md-button type="submit" class="md-primary"
                         ng-click="!editProductStock.$valid || addProductToCycle()">Guardar
              </md-button>
            </md-card-actions>
          </md-card>
        </form>
      </div>
    </div>

  </div>
</md-dialog>
